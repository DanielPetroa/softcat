{% extends 'base_dashboard.html' %}
{% load static %}

{% block title %}Dashboard - LCK Insurance System{% endblock %}

{% block content %}
<!-- Page-Title -->
<div class="row">
    <div class="col-sm-12">
        <div class="page-title-box">
            <div class="row">
                <div class="col">
                    <h4 class="page-title">Dashboard</h4>
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="javascript:void(0);">LCK Insurance</a></li>
                        <li class="breadcrumb-item active">Dashboard</li>
                    </ol>
                </div><!--end col-->
                <div class="col-auto align-self-center">
                    <a href="#" class="btn btn-sm btn-outline-primary" id="Dash_Date">
                        <span class="day-name" id="Day_Name">Today:</span>&nbsp;
                        <span class="" id="Select_date">{% now "M d" %}</span>
                        <i data-feather="calendar" class="align-self-center icon-xs ml-1"></i>
                    </a>
                </div><!--end col-->  
            </div><!--end row-->                                                              
        </div><!--end page-title-box-->
    </div><!--end col-->
</div><!--end row-->
<!-- end page title end breadcrumb -->

<!-- Welcome Section -->
<div class="row">
    <div class="col-12">
        <div class="card bg-primary text-white">
            <div class="card-body">
                <div class="row align-items-center">
                    <div class="col">
                        <h4 class="text-white">Welcome back, {{ user.username }}!</h4>
                        <p class="mb-0">You are logged in as {{ user.get_role_display }}. Here's your dashboard overview.</p>
                    </div>
                    <div class="col-auto">
                        <i data-feather="user-check" class="align-self-center text-white" style="width: 48px; height: 48px;"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Stats Cards -->
<div class="row justify-content-center">
    <div class="col-md-6 col-lg-3">
        <div class="card report-card">
            <div class="card-body">
                <div class="row d-flex justify-content-center">
                    <div class="col">
                        <p class="text-dark mb-1 font-weight-semibold">Active Users</p>
                        <h3 class="my-2">{% if user.role == 'admin' %}{{ total_users|default:'--' }}{% else %}--{% endif %}</h3>
                        <p class="mb-0 text-truncate text-muted">
                            <span class="text-success"><i class="mdi mdi-trending-up"></i>Active</span> 
                            System Users
                        </p>
                    </div>
                    <div class="col-auto align-self-center">
                        <div class="report-main-icon bg-light-alt">
                            <i data-feather="users" class="align-self-center text-muted icon-md"></i>  
                        </div>
                    </div>
                </div>
            </div><!--end card-body--> 
        </div><!--end card--> 
    </div> <!--end col--> 
    
    <div class="col-md-6 col-lg-3">
        <div class="card report-card">
            <div class="card-body">
                <div class="row d-flex justify-content-center">                                                
                    <div class="col">
                        <p class="text-dark mb-1 font-weight-semibold">Total Clients</p>
                        <h3 class="my-2">--</h3>
                        <p class="mb-0 text-truncate text-muted">
                            <span class="text-info"><i class="mdi mdi-trending-up"></i>Coming Soon</span> 
                            Client Management
                        </p>
                    </div>
                    <div class="col-auto align-self-center">
                        <div class="report-main-icon bg-light-alt">
                            <i data-feather="user-check" class="align-self-center text-muted icon-md"></i>  
                        </div>
                    </div> 
                </div>
            </div><!--end card-body--> 
        </div><!--end card--> 
    </div> <!--end col--> 
    
    <div class="col-md-6 col-lg-3">
        <div class="card report-card">
            <div class="card-body">
                <div class="row d-flex justify-content-center">                                                
                    <div class="col">
                        <p class="text-dark mb-1 font-weight-semibold">Geometries</p>
                        <h3 class="my-2">--</h3>
                        <p class="mb-0 text-truncate text-muted">
                            <span class="text-warning"><i class="mdi mdi-trending-up"></i>In Development</span> 
                            Geographic Data
                        </p>
                    </div>
                    <div class="col-auto align-self-center">
                        <div class="report-main-icon bg-light-alt">
                            <i data-feather="map" class="align-self-center text-muted icon-md"></i>  
                        </div>
                    </div> 
                </div>
            </div><!--end card-body--> 
        </div><!--end card--> 
    </div> <!--end col--> 
    
    <div class="col-md-6 col-lg-3">
        <div class="card report-card">
            <div class="card-body">
                <div class="row d-flex justify-content-center">
                    <div class="col">  
                        <p class="text-dark mb-1 font-weight-semibold">System Status</p>                                         
                        <h3 class="my-2">Online</h3>
                        <p class="mb-0 text-truncate text-muted">
                            <span class="text-success"><i class="mdi mdi-trending-up"></i>100%</span> 
                            System Uptime
                        </p>
                    </div>
                    <div class="col-auto align-self-center">
                        <div class="report-main-icon bg-light-alt">
                            <i data-feather="activity" class="align-self-center text-muted icon-md"></i>  
                        </div>
                    </div> 
                </div>
            </div><!--end card-body--> 
        </div><!--end card--> 
    </div> <!--end col-->                               
</div><!--end row-->

<!-- Main Content Row -->
<div class="row">
    <!-- Quick Actions -->
    <div class="col-lg-6">
        <div class="card">
            <div class="card-header">
                <div class="row align-items-center">
                    <div class="col">                      
                        <h4 class="card-title">Quick Actions</h4>                      
                    </div><!--end col-->
                </div>  <!--end row-->                                  
            </div><!--end card-header-->
            <div class="card-body">
                <div class="row">
                    {% if user.role == 'admin' %}
                    <div class="col-md-6 mb-3">
                        <a href="{% url 'user_create' %}" class="btn btn-primary btn-block">
                            <i data-feather="user-plus" class="mr-2"></i>
                            Add New User
                        </a>
                    </div>
                    <div class="col-md-6 mb-3">
                        <a href="{% url 'user_list' %}" class="btn btn-outline-primary btn-block">
                            <i data-feather="users" class="mr-2"></i>
                            Manage Users
                        </a>
                    </div>
                    {% endif %}
                    <div class="col-md-6 mb-3">
                        <a href="#" onclick="alert('Clients module coming soon!')" class="btn btn-outline-info btn-block">
                            <i data-feather="user-check" class="mr-2"></i>
                            View Clients
                        </a>
                    </div>
                    <div class="col-md-6 mb-3">
                        <a href="{% url 'change_password' %}" class="btn btn-outline-secondary btn-block">
                            <i data-feather="lock" class="mr-2"></i>
                            Change Password
                        </a>
                    </div>
                </div>
            </div><!--end card-body--> 
        </div><!--end card--> 
    </div> <!--end col-->
    
    <!-- Recent Activity -->
    <div class="col-lg-6">
        <div class="card">   
            <div class="card-header">
                <div class="row align-items-center">
                    <div class="col">                      
                        <h4 class="card-title">Recent Activity</h4>                      
                    </div><!--end col-->
                </div>  <!--end row-->                                  
            </div><!--end card-header-->                                              
            <div class="card-body"> 
                <div class="analytic-dash-activity" data-simplebar>
                    <div class="activity">
                        <div class="activity-info">
                            <div class="icon-info-activity">
                                <i class="las la-user-clock bg-soft-primary"></i>
                            </div>
                            <div class="activity-info-text">
                                <div class="d-flex justify-content-between align-items-center">
                                    <p class="text-muted mb-0 font-13 w-75">
                                        <span>{{ user.username }}</span> logged into the system
                                    </p>
                                    <small class="text-muted">Just now</small>
                                </div>    
                            </div>
                        </div>   

                        <div class="activity-info">
                            <div class="icon-info-activity">
                                <i class="mdi mdi-shield-check bg-soft-success"></i>
                            </div>
                            <div class="activity-info-text">
                                <div class="d-flex justify-content-between align-items-center">
                                    <p class="text-muted mb-0 font-13 w-75">
                                        System security scan completed successfully
                                    </p>
                                    <small class="text-muted">2 hours ago</small>
                                </div>    
                            </div>
                        </div>   

                        <div class="activity-info">
                            <div class="icon-info-activity">
                                <i class="mdi mdi-database bg-soft-info"></i>
                            </div>
                            <div class="activity-info-text">
                                <div class="d-flex justify-content-between align-items-center">
                                    <p class="text-muted mb-0 font-13 w-75">
                                        Database backup completed
                                    </p>
                                    <small class="text-muted">Yesterday</small>
                                </div>    
                            </div>
                        </div>   

                        <div class="activity-info">
                            <div class="icon-info-activity">
                                <i class="mdi mdi-update bg-soft-warning"></i>
                            </div>
                            <div class="activity-info-text">
                                <div class="d-flex justify-content-between align-items-center">
                                    <p class="text-muted mb-0 font-13 w-75">
                                        System updated to latest version
                                    </p>
                                    <small class="text-muted">2 days ago</small>
                                </div>    
                            </div>
                        </div>                                                                                                                                   
                    </div><!--end activity-->
                </div><!--end analytics-dash-activity-->
            </div>  <!--end card-body-->                                     
        </div><!--end card--> 
    </div><!--end col-->
</div><!--end row-->

{% if user.role == 'admin' %}
<!-- Admin Panel -->
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h4 class="card-title">Administrator Panel</h4>
                <p class="text-muted mb-0">You have admin access to manage the system.</p>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-3">
                        <div class="text-center">
                            <i data-feather="users" class="text-primary mb-2" style="width: 32px; height: 32px;"></i>
                            <h5>User Management</h5>
                            <p class="text-muted">Create, edit, and manage system users</p>
                            <a href="{% url 'user_list' %}" class="btn btn-primary btn-sm">Manage Users</a>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="text-center">
                            <i data-feather="user-check" class="text-info mb-2" style="width: 32px; height: 32px;"></i>
                            <h5>Client Management</h5>
                            <p class="text-muted">Manage client information and policies</p>
                            <button class="btn btn-info btn-sm" onclick="alert('Coming soon!')">Coming Soon</button>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="text-center">
                            <i data-feather="map" class="text-warning mb-2" style="width: 32px; height: 32px;"></i>
                            <h5>Geometries</h5>
                            <p class="text-muted">Manage geographic data and boundaries</p>
                            <button class="btn btn-warning btn-sm" onclick="alert('In development!')">In Development</button>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="text-center">
                            <i data-feather="settings" class="text-secondary mb-2" style="width: 32px; height: 32px;"></i>
                            <h5>Django Admin</h5>
                            <p class="text-muted">Access advanced system settings</p>
                            <a href="/admin/" class="btn btn-secondary btn-sm" target="_blank">Django Admin</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% else %}
<!-- Client Panel -->
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h4 class="card-title">Client Panel</h4>
                <p class="text-muted mb-0">Here you can view your policies and information.</p>
            </div>
            <div class="card-body">
                <div class="text-center py-4">
                    <i data-feather="user-check" class="text-primary mb-3" style="width: 64px; height: 64px;"></i>
                    <h5>Welcome to your client dashboard</h5>
                    <p class="text-muted">Client features will be available soon. You can change your password using the menu.</p>
                    <a href="{% url 'change_password' %}" class="btn btn-primary">Change Password</a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endif %}
{% endblock %}